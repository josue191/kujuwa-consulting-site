
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Règle permissive temporaire pour le développement
    // Autorise la lecture à tous les utilisateurs connectés.
    // À remplacer par des règles granulaires avant la production.
    match /{document=**} {
      allow read: if request.auth != null;
      // Interdit les écritures par défaut, sauf si une règle plus spécifique l'autorise.
      allow write: if false;
    }
    
    // Autorise n'importe qui à soumettre un formulaire de contact.
    // Autorise les utilisateurs connectés (admins) à supprimer les soumissions.
    match /contactFormSubmissions/{contactFormSubmissionId} {
      allow create: if true;
      allow delete: if request.auth != null;
    }

    // Autorise n'importe qui à créer une candidature pour une offre d'emploi.
    // C'est sécurisé car ils ne peuvent ni lire, ni mettre à jour, ni supprimer les candidatures.
    match /jobPostings/{jobPostingId}/applications/{applicationId} {
      allow create: if true;
    }
    
    // Autorise les requêtes de groupe sur la collection 'applications' pour les utilisateurs connectés (admins).
    match /{path=**}/applications/{applicationId} {
      allow read, list: if request.auth != null;
    }
  }
}
